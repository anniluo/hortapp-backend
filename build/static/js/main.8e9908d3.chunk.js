(this["webpackJsonphortapp-front"]=this["webpackJsonphortapp-front"]||[]).push([[0],{27:function(e,t,n){},43:function(e,t,n){e.exports=n(77)},48:function(e,t,n){},49:function(e,t,n){},51:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(15),c=n.n(o),l=(n(48),n(49),n(8)),u=n.n(l),s=n(11),i=n(7),m=n(30),d=n(29),p=n(31),f=n(33),b=n(32),h=(n(51),function(e){var t=e.resourceMarker;return r.a.createElement(d.a,{className:"popup-container"},r.a.createElement("div",{className:"popup-header-container"},r.a.createElement("img",{className:"resource-icon",src:t.natureResource.iconUrl,alt:"Icon for resource"}),r.a.createElement("h5",{id:"nature-resource-name"},t.natureResource.name.en," "),r.a.createElement("p",{id:"harvest-info"},"From: ",r.a.createElement("b",null,t.natureResource.harvestSeason.start),r.a.createElement("br",null),"To: ",r.a.createElement("b",null,t.natureResource.harvestSeason.end))),r.a.createElement("div",{className:"popup-info-container"},r.a.createElement("h5",{id:"address-text"},r.a.createElement("b",null,t.locationName)),r.a.createElement("p",{id:"date-user-info-text"},"Added by ",r.a.createElement("b",null,t.addedByUser.username)," on:"," ",r.a.createElement("b",null,t.date.slice(0,10))),t.comment&&r.a.createElement("p",{id:"user-comment-text"},t.comment)))}),g=function(e){var t=e.marker,n=e.userId,a=e.selectedFilterOptions;return r.a.createElement(r.a.Fragment,null,a.includes(t.natureResource.category.toLowerCase())||null!==n&&t.addedByUser.id===n&&a.includes("myMarkers")?r.a.createElement(m.a,{key:t.id,position:[t.latLng.latitude,t.latLng.longitude]},r.a.createElement(h,{resourceMarker:t})):void 0)},E=n(25),v=n.n(E),k=(n(55),function(e){var t=e.buttonPosition,n=e.toolTipText,a=e.buttonId,o=e.buttonOnClick;return r.a.createElement(v.a,{position:t},r.a.createElement("button",{onClick:o,className:"round-button tooltip",id:a},r.a.createElement("span",{className:"tooltiptext"}," ",n)))}),O=(n(56),n(27),function(e){var t=e.toggle,n=e.content,o=Object(a.useState)(!1),c=Object(i.a)(o,2),l=c[0],u=c[1],s=function(){var e=document.getElementById("modal-background");e.classList.contains("hidden-modal-background")?e.classList.remove("hidden-modal-background"):e.classList.add("hidden-modal-background")};return r.a.createElement(r.a.Fragment,null,t((function(){s(),u(!0)})),l&&n((function(){s(),u(!1)})))}),j=n(13),C=n.n(j),w={login:function(){var e=Object(s.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},N={signup:function(){var e=Object(s.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post("/api/signup",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},x=null,y={getAll:function(){return C.a.get("/api/resourceMarkers").then((function(e){return e.data}))},create:function(){var e=Object(s.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:x}},e.next=3,C.a.post("/api/resourceMarkers",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(e,t){return C.a.put("".concat("/api/resourceMarkers","/").concat(e),t).then((function(e){return e.data}))},setToken:function(e){x="bearer ".concat(e)}},S=function(e,t){window.sessionStorage.setItem(e,JSON.stringify(t))},M=function(e){window.sessionStorage.removeItem(e)},T=function(e){return window.sessionStorage.getItem(e)},I=n(9),F=function(e){var t=e.modalHeaderText,n=e.hideModalOnClick,o=e.formId,l=e.handleUserChange,m=Object(a.useState)(null),d=Object(i.a)(m,2),p=d[0],f=d[1],b=Object(a.useState)(null),h=Object(i.a)(b,2),g=h[0],E=h[1],v=Object(a.useState)(""),k=Object(i.a)(v,2),O=k[0],j=k[1],C=Object(a.useState)(""),x=Object(i.a)(C,2),M=x[0],T=x[1],F=Object(a.useState)(""),U=Object(i.a)(F,2),P=U[0],A=U[1],R=Object(a.useState)(""),L=Object(i.a)(R,2),B=L[0],H=L[1];Object(a.useEffect)((function(){q()}),[]);var q=function(){var e=document.getElementsByClassName("close-modal-button");e.length>1&&e[0].click()},D=function(){var e=Object(s.a)(u.a.mark((function e(t){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),"",""!==O&&""!==P){e.next=7;break}return a={message:"Missing Username or Password"},f(Object(I.handleError)(a)),setTimeout((function(){f(null)}),5e3),e.abrupt("return");case 7:return e.prev=7,e.next=10,w.login({username:O,password:P});case 10:r=e.sent,S("loggedHortappUser",r),y.setToken(r.token),j(""),A(""),n(),l(r),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(7),f(Object(I.handleError)(e.t0)),setTimeout((function(){f(null)}),5e3);case 23:case"end":return e.stop()}}),e,null,[[7,19]])})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(s.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n="",""!==M&&""!==O&&""!==P){e.next=7;break}return n={message:"Missing Username, Password or Email"},f(Object(I.handleError)(n)),setTimeout((function(){f(null)}),5e3),e.abrupt("return");case 7:if(!(O.length<4||P.length<8)){e.next=12;break}return n={message:"Short Username or Password"},f(Object(I.handleError)(n)),setTimeout((function(){f(null)}),5e3),e.abrupt("return");case 12:if(B===P){e.next=17;break}return n={message:"Incorrect Match"},f(Object(I.handleError)(n)),setTimeout((function(){f(null)}),5e3),e.abrupt("return");case 17:return e.prev=17,e.next=20,N.signup({email:M,username:O,password:P});case 20:T(""),j(""),A(""),H(""),E("Account created succesfully!"),e.next=31;break;case 27:e.prev=27,e.t0=e.catch(17),f(Object(I.handleError)(e.t0)),setTimeout((function(){f(null)}),5e3);case 31:case"end":return e.stop()}}),e,null,[[17,27]])})));return function(t){return e.apply(this,arguments)}}();return c.a.createPortal(r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"modal-container"},r.a.createElement("div",{className:"modal-header-container"},r.a.createElement("h5",null,t),r.a.createElement("button",{className:"close-modal-button no-border",onClick:n})),""!==o?r.a.createElement(r.a.Fragment,null,null!==g?r.a.createElement("div",{className:"modal-success-container"},r.a.createElement("p",{className:"success-message-text"},g)):null,null!==p?r.a.createElement("div",{className:"modal-error-container"},r.a.createElement("p",{className:"error-message-text"},p)):null,r.a.createElement("form",{id:o,className:"modal-form",onSubmit:"login-form"===o?D:z},r.a.createElement("input",{className:"login-form"===o?"hidden form-input":"form-input",type:"email",placeholder:"e-mail",value:M,onChange:function(e){var t=e.target;return T(t.value)}}),r.a.createElement("input",{className:"form-input",type:"text",placeholder:"username",value:O,onChange:function(e){var t=e.target;return j(t.value)}}),r.a.createElement("input",{className:"form-input",type:"password",placeholder:"password",value:P,onChange:function(e){var t=e.target;return A(t.value)}}),r.a.createElement("input",{className:"login-form"===o?"hidden form-input":"form-input",type:"password",placeholder:"confirm password",value:B,onChange:function(e){var t=e.target;return H(t.value)}}),r.a.createElement("input",{className:"modal-form-submit",type:"submit",value:"Confirm"}))):r.a.createElement("div",{className:"about-app-container"},"Hortapp is a map application to mark locations of different types of nature resources."))),document.getElementById("modal-root"))},U=function(e){var t=e.menuIsOpen,n=e.onMenuButtonClick,a=e.user,o=e.handleUserChange,c=e.selectedFilterOptions,l=e.handleFilterOptionsChange;return t?r.a.createElement("div",{className:"menu-container"},r.a.createElement("div",{className:"menu-header-container"},r.a.createElement("h4",{className:"menu-header-text",onClick:n},"Hortapp"),r.a.createElement("button",{onClick:n,className:"menu-button menu-open-icon"}),a&&r.a.createElement("p",null,"Logged in as ",r.a.createElement("b",null,a.username))),r.a.createElement("div",{className:"menu-contents"},r.a.createElement("div",{className:"filter-container"},r.a.createElement("p",null,"Filter Options"),r.a.createElement("div",{className:"filter-options-container"},null!==a?r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"checkbox",name:"my-markers",id:"my-markers-filter",value:"myMarkers",onChange:function(e){return l(e.target.value)},checked:c.includes("myMarkers")}),r.a.createElement("label",{htmlFor:"my-markers"},"My markers")):null,r.a.createElement("input",{type:"checkbox",name:"berries",id:"berries-filter",value:"berries",onChange:function(e){return l(e.target.value)},checked:c.includes("berries")}),r.a.createElement("label",{htmlFor:"berries"},"Berries"),r.a.createElement("input",{type:"checkbox",name:"mushrooms",id:"mushrooms-filter",value:"mushrooms",onChange:function(e){return l(e.target.value)},checked:c.includes("mushrooms")}),r.a.createElement("label",{htmlFor:"mushrooms"},"Mushrooms"),r.a.createElement("input",{type:"checkbox",name:"greens",id:"greens-filter",value:"greens",onChange:function(e){return l(e.target.value)},checked:c.includes("greens")}),r.a.createElement("label",{htmlFor:"greens"},"Greens"))),null===a?r.a.createElement(r.a.Fragment,null,r.a.createElement(O,{toggle:function(e){return r.a.createElement("button",{className:"full-button square-button no-border",onClick:e},"Log in")},content:function(e){return r.a.createElement(F,{modalHeaderText:"Login to Hortapp",hideModalOnClick:e,formId:"login-form",user:a,handleUserChange:o})}}),r.a.createElement(O,{toggle:function(e){return r.a.createElement("button",{className:"full-button square-button no-border",onClick:e},"Sign up")},content:function(e){return r.a.createElement(F,{modalHeaderText:"Signup to Hortapp",hideModalOnClick:e,formId:"signup-form"})}})):r.a.createElement("button",{className:"full-button square-button no-border",onClick:function(e){e.preventDefault(),M("loggedHortappUser"),o(null)}},"Log out"),r.a.createElement(O,{toggle:function(e){return r.a.createElement("button",{className:"full-button square-button no-border",onClick:e},"About")},content:function(e){return r.a.createElement(F,{modalHeaderText:"About Hortapp",hideModalOnClick:e,formId:""})}}))):r.a.createElement(v.a,{position:"topleft"},r.a.createElement("button",{onClick:n,className:"menu-button menu-closed-icon"}))},P=(n(74),n(75),n(76),function(e){var t=e.dropdownMenuIsOpen,n=e.handleDropdownMenuToggle,a=e.handleResourceChange,o=e.resources,c=e.chosenResource;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"dropdown-container"},r.a.createElement("button",{className:"dropdown-menu-button square-button",onClick:n},r.a.createElement("i",{className:"fa fa-caret-down"})),r.a.createElement("p",{className:"resource-name"},c.name)),r.a.createElement("div",{className:"dropdown-content"},t&&o?o.map((function(e){return r.a.createElement("button",{className:"resource-button",key:e.id,onClick:function(){a(e)}},e.name.en)})):null))}),A=function(){return C.a.get("/api/natureResources").then((function(e){return e.data}))},R=function(e){var t=e.hideModalOnClick,n=e.chosenLocation,o=e.user,l=e.updateMarkers,m=e.handleAddMarkerModeChange,d=Object(a.useState)(null),p=Object(i.a)(d,2),f=p[0],b=p[1],h=Object(a.useState)(null),g=Object(i.a)(h,2),E=g[0],v=g[1],k=Object(a.useState)(!1),O=Object(i.a)(k,2),j=O[0],C=O[1],w=Object(a.useState)(""),N=Object(i.a)(w,2),x=N[0],S=N[1],M=Object(a.useState)(""),T=Object(i.a)(M,2),F=T[0],U=T[1],R=Object(a.useState)({name:"",id:""}),L=Object(i.a)(R,2),B=L[0],H=L[1];Object(a.useEffect)((function(){q()}),[]);var q=function(){var e=Object(s.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A();case 3:t=e.sent,v(t),e.next=12;break;case 7:e.prev=7,e.t0=e.catch(0),Object(I.handleError)(e.t0),b("Error occured while trying to fetch resources"),setTimeout((function(){b(null)}),5e3);case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),D=function(e){H({name:e.name.en,id:e.id}),C(!1)},z=function(){var e=Object(s.a)(u.a.mark((function e(a){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),r="",""!==x&&""!==B.id){e.next=7;break}return r={message:"Missing Address or Resource"},b(Object(I.handleError)(r)),setTimeout((function(){b(null)}),5e3),e.abrupt("return");case 7:if(!(x.length<6)){e.next=12;break}return r={message:"Short Address"},b(Object(I.handleError)(r)),setTimeout((function(){b(null)}),5e3),e.abrupt("return");case 12:if(!(F.length<=10&&F.length>0)){e.next=17;break}return r={message:"Short Comment"},b(Object(I.handleError)(r)),setTimeout((function(){b(null)}),5e3),e.abrupt("return");case 17:return e.prev=17,e.next=20,y.create({latLng:{latitude:n.lat,longitude:n.long},locationName:x,date:Date.now(),userId:o.id,comment:F,natureResource:B.id});case 20:S(""),D(E[0]),U(""),l(),t(),m(),e.next=32;break;case 28:e.prev=28,e.t0=e.catch(17),b(Object(I.handleError)(e.t0)),setTimeout((function(){b(null)}),5e3);case 32:case"end":return e.stop()}}),e,null,[[17,28]])})));return function(t){return e.apply(this,arguments)}}();return c.a.createPortal(r.a.createElement("div",{className:"modal-container"},r.a.createElement("div",{className:"modal-header-container"},r.a.createElement("h5",null,"Add a New Marker"),r.a.createElement("button",{id:"close-modal-button",onClick:t})),null!==f?r.a.createElement("div",{className:"modal-error-container"},r.a.createElement("p",{className:"error-message-text"},f)):null,r.a.createElement("form",{id:"marker-form",className:"modal-form",onSubmit:z},r.a.createElement("input",{className:"form-input",type:"text",placeholder:"address",value:x,onChange:function(e){var t=e.target;return S(t.value)}}),r.a.createElement(P,{dropdownMenuIsOpen:j,handleResourceChange:D,handleDropdownMenuToggle:function(e){e.preventDefault(),C(!j)},resources:E,chosenResource:B}),r.a.createElement("label",{htmlFor:"resource-comment",hidden:!0},"Comment:"),r.a.createElement("textarea",{id:"resource-comment",placeholder:"write a comment (optional)",value:F,onChange:function(e){var t=e.target;return U(t.value)}}),r.a.createElement("input",{className:"modal-form-submit",type:"submit",value:"Confirm"}))),document.getElementById("modal-root"))},L=function(){var e=Object(a.useRef)(),t=Object(a.useRef)(),n=Object(a.useState)(null),o=Object(i.a)(n,2),c=o[0],l=o[1],h=Object(a.useState)(!1),E=Object(i.a)(h,2),v=E[0],j=E[1],C=Object(a.useState)(!1),w=Object(i.a)(C,2),N=w[0],x=w[1],S=Object(a.useState)([]),M=Object(i.a)(S,2),F=M[0],P=M[1],A=Object(a.useState)([[59.44507,19.08325],[70.0988,31.62826]]),L=Object(i.a)(A,1)[0],B=Object(a.useState)("13"),H=Object(i.a)(B,2),q=H[0],D=H[1],z=Object(a.useState)([60.192059,24.945831]),J=Object(i.a)(z,2),Z=J[0],G=J[1],K=Object(a.useState)({lat:null,long:null}),Q=Object(i.a)(K,2),V=Q[0],W=Q[1],X=Object(a.useState)(["berries","mushrooms","greens"]),Y=Object(i.a)(X,2),$=Y[0],_=Y[1];Object(a.useEffect)((function(){ae()}),[]),Object(a.useEffect)((function(){var e=T("loggedHortappUser");if(e){var t=JSON.parse(e);te(t),y.setToken(t.token)}}),[]);var ee=function(e){if($.includes(e)){var t=$.filter((function(t){return t!==e}));_(t)}else _($.concat(e))},te=function(e){l(e)},ne=function(){var t=e.current;null!=t&&t.leafletElement.closePopup()},ae=function(){var e=Object(s.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.getAll();case 3:t=e.sent,P(t),e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),alert(Object(I.handleError)(e.t0)),e.abrupt("return");case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),re=function(){if(null!=e.current)for(var t=document.getElementsByClassName("leaflet-marker-icon"),n=0;t.length>n;n++)t[n].style.pointerEvents=N?"auto":"none"},oe=function(){navigator.geolocation.getCurrentPosition((function(e){G([e.coords.latitude,e.coords.longitude]),D(ue())}),(function(e){alert(Object(I.handleError)(e))}))},ce=function(){ne(),j(!v)},le=function(){N?(se(),re(),x(!1)):(re(),x(!0))},ue=function(){var t=e.current;return null!==t?t.leafletElement.getZoom():q},se=function(){W({lat:null,long:null})};return r.a.createElement(r.a.Fragment,null,N&&r.a.createElement("div",{id:"add-mode-container"},r.a.createElement("p",null,"Choose a Location")),r.a.createElement("div",{id:"modal-root"}),r.a.createElement("div",{id:"modal-background",className:"hidden-modal-background"}),r.a.createElement(p.a,{maxBounds:L,id:"hortapp-map",center:Z,zoom:q,minZoom:6,maxZoom:15,zoomControl:!1,onClick:function(e){N&&(W({lat:e.latlng.lat,long:e.latlng.lng}),function(){if(N&&0===document.getElementsByClassName("leaflet-popup-content-wrapper").length){var e=t.current;null!=e&&e.leafletElement.openPopup()}}())},ref:e},r.a.createElement(f.a,{position:"topright"}),r.a.createElement(b.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),r.a.createElement(r.a.Fragment,null,r.a.createElement(k,{buttonPosition:"bottomright",toolTipText:"Get your Location",buttonId:"location-round-button",buttonOnClick:oe}),N?r.a.createElement(k,{buttonPosition:"bottomright",toolTipText:"Cancel and go back to map view",buttonId:"cancel-round-button",buttonOnClick:le}):null!==c?r.a.createElement(k,{buttonPosition:"bottomright",toolTipText:"Add a New Marker",buttonId:"add-round-button",buttonOnClick:le}):null),F?F.map((function(e){return r.a.createElement(g,{key:e.id,marker:e,selectedFilterOptions:$,userId:c?c.id:null})})):null,N?null:r.a.createElement(U,{onMenuButtonClick:ce,menuIsOpen:v,user:c,handleUserChange:te,selectedFilterOptions:$,handleFilterOptionsChange:ee}),null===V.lat?null:r.a.createElement(m.a,{ref:t,position:[V.lat,V.long]},r.a.createElement(d.a,{closeButton:!1,closeOnClick:!1},r.a.createElement("div",{className:"modal-header-container"},r.a.createElement("h5",{id:"confirm-modal-header-text"},"Confirm chosen location")),r.a.createElement("div",{className:"modal-text-container"},r.a.createElement("p",null,"Do you want to confirm this location:"),r.a.createElement("p",null,"latitute: ",r.a.createElement("b",null,V.lat)," ",r.a.createElement("br",null),"longitude: ",r.a.createElement("b",null,V.long),"?")),r.a.createElement("div",{className:"modal-buttons-container"},r.a.createElement(O,{toggle:function(e){return r.a.createElement("button",{className:"confirm-modal-button",onClick:e},"Confirm")},content:function(e){return ne(),r.a.createElement(R,{hideModalOnClick:e,chosenLocation:V,user:c,updateMarkers:ae,handleAddMarkerModeChange:le})}}),r.a.createElement("button",{className:"confirm-modal-button",onClick:se},"Cancel"))))))},B=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(L,null))};c.a.render(r.a.createElement(B,null),document.getElementById("root"))},9:function(e,t){e.exports={handleError:function(e){var t=[];switch(e.message){case"Network Error":t.push("Could not fetch markers due to Network Error");break;case"User denied geolocation prompt":t.push("Request to get the device location was denied");break;case"Missing Address or Resource":t.push("Address and Resource are required");break;case"Request failed with status code 401":t.push("Incorrect Username or Password");break;case"Missing Username or Password":t.push("Username and Password are required");break;case"Missing Username, Password or Email":t.push("Email, Username and Password are required");break;case"Short Address":t.push("Address must be at least 6 characters long");break;case"Short Username or Password":t.push("Username must be at least 4 characters long and Password must be at least 8 characters long");break;case"Short Comment":t.push("Comment must be at least 10 characters long");break;case"Incorrect Match":t.push("Password and Confirmation password do not match.");break;default:t.push("Error occured: ".concat(e.message))}return t}}}},[[43,1,2]]]);
//# sourceMappingURL=main.8e9908d3.chunk.js.map